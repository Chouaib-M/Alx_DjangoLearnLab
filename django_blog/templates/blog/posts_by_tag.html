{% extends "blog/base.html" %}

{% block content %}
<div class="tag-header mb-4">
  <h1>Posts tagged with "{{ tag.name }}"</h1>
  <p class="text-muted">{{ total_results }} post{{ total_results|pluralize }} found</p>
</div>

<!-- Posts List -->
<div class="posts-list">
  {% for post in posts %}
  <div class="post-item mb-4 p-3 border rounded">
    <h3><a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a></h3>
    <p class="text-muted">By {{ post.author.username }} on {{ post.published_date|date:"F d, Y" }}</p>
    
    <div class="post-excerpt">
      {{ post.content|truncatewords:30|linebreaks }}
    </div>
    
    {% if post.tags.all %}
    <div class="post-tags mt-2">
      <small class="text-muted">Tags: </small>
      {% for post_tag in post.tags.all %}
        <a href="{% url 'posts_by_tag' post_tag.slug %}" class="badge bg-secondary text-decoration-none me-1">{{ post_tag.name }}</a>
      {% endfor %}
    </div>
    {% endif %}
    
    <div class="post-meta mt-2">
      <a href="{% url 'post_detail' post.pk %}" class="btn btn-sm btn-outline-primary">Read More</a>
      <small class="text-muted ms-3">{{ post.comments.count }} comment{{ post.comments.count|pluralize }}</small>
    </div>
  </div>
  {% empty %}
  <div class="no-posts text-center py-5">
    <h4>No posts found with this tag</h4>
    <p class="text-muted">This tag doesn't have any posts yet.</p>
    <a href="{% url 'posts_list' %}" class="btn btn-primary">View All Posts</a>
  </div>
  {% endfor %}
</div>

<div class="mt-4">
  <a href="{% url 'posts_list' %}" class="btn btn-secondary">Back to All Posts</a>
</div>
{% endblock %}
