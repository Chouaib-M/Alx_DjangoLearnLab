{% extends "blog/base.html" %}

{% block content %}
<div class="search-header mb-4">
  <h1>Search Results</h1>
  {% if query %}
    <p class="text-muted">Results for "<strong>{{ query }}</strong>" - {{ total_results }} post{{ total_results|pluralize }} found</p>
  {% else %}
    <p class="text-muted">Enter a search term to find posts</p>
  {% endif %}
</div>

<!-- Search Form -->
<div class="search-form mb-4">
  <form method="get" action="{% url 'search_posts' %}">
    <div class="input-group">
      <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="Search posts by title, content, or tags...">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>
</div>

<!-- Search Results -->
<div class="search-results">
  {% for post in posts %}
  <div class="post-item mb-4 p-3 border rounded">
    <h3><a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a></h3>
    <p class="text-muted">By {{ post.author.username }} on {{ post.published_date|date:"F d, Y" }}</p>
    
    <div class="post-excerpt">
      {{ post.content|truncatewords:30|linebreaks }}
    </div>
    
    {% if post.tags.all %}
    <div class="post-tags mt-2">
      <small class="text-muted">Tags: </small>
      {% for tag in post.tags.all %}
        <a href="{% url 'posts_by_tag' tag.slug %}" class="badge bg-secondary text-decoration-none me-1">{{ tag.name }}</a>
      {% endfor %}
    </div>
    {% endif %}
    
    <div class="post-meta mt-2">
      <a href="{% url 'post_detail' post.pk %}" class="btn btn-sm btn-outline-primary">Read More</a>
      <small class="text-muted ms-3">{{ post.comments.count }} comment{{ post.comments.count|pluralize }}</small>
    </div>
  </div>
  {% empty %}
    {% if query %}
      <div class="no-results text-center py-5">
        <h4>No posts found</h4>
        <p class="text-muted">Try searching with different keywords or browse all posts.</p>
        <a href="{% url 'posts_list' %}" class="btn btn-primary">View All Posts</a>
      </div>
    {% endif %}
  {% endfor %}
</div>

<div class="mt-4">
  <a href="{% url 'posts_list' %}" class="btn btn-secondary">Back to All Posts</a>
</div>
{% endblock %}
